let u=parseInt(localStorage.getItem("vista_indice"));if(localStorage.getItem("indicesViews")){let t=localStorage.getItem("indicesViews"),e=JSON.parse(t),a=e[5];console.log(a.id),console.log(a.vista_guardada);let i=e.find(s=>s.id===u),c=a.id,l=a.vista_guardada===1;c!=u&&l&&f(i.variable_ruta),c!=u&&!l&&f(i.variable_ruta)}else alert("No se ha creado ningun curso, se te redirecionara al panel de control!!"),window.location.href=route("home");function f(t){window.location.href=route(t)}let h=localStorage.getItem("dataObjetivos"),_=JSON.parse(h),n;localStorage.getItem("copiaGetDataObjetivos3d")?n=JSON.parse(localStorage.getItem("copiaGetDataObjetivos3d")):(n=[..._],localStorage.setItem("copiaGetDataObjetivos3d",JSON.stringify(n)));let m=document.getElementById("selectObjetivoParticular"),r=0,b=document.getElementById("objetivos_id"),y,v=document.getElementById("myForm");v.style.display="none";n.map(t=>{let e=document.createElement("option");e.text=t.descripcion,e.value=t.id,m.add(e)});m.onchange=function(){let t=Number(this.value);t!==0?v.style.display="block":v.style.display="none",r=n.find(i=>i.id===t);let e="";e+=`
    <label for="">Cantidad de Beneficios</label>
    <input type="number" name="cantidadPreguntas" name="cantidadPreguntas" id="cantidadPreguntas" required>
    <br>
    <label for="exampleInputName" class="form-label">Preguntas:</label>
    <div id="divPreguntas">
    </div>
    `,document.getElementById("divBeneficios").innerHTML=e,w(),b.value=r.id;let a=this.options[this.selectedIndex];b.text=a.text,console.log("El objeto seleccionado es: ",r)};document.getElementById("myForm").addEventListener("submit",t=>{t.preventDefault();const e=route("seccion3d-store"),a=new FormData(t.target),i=Object.fromEntries(a.entries());i.indice=r.id,document.getElementById("cantidadPreguntas")&&(y=document.getElementById("cantidadPreguntas").value),i.beneficios=[];for(let o=0;o<y;o++){const d={};d.beneficio=document.getElementById(`actividad[${o}]`).value,i.beneficios.push(d)}console.log(i);const c={method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(i)};fetch(e,c).then(o=>o.json()).then(o=>{console.log(o),v.style.display="none",document.getElementById("divBeneficios").innerHTML="",console.log("indice para eliminar "+r),n=n.filter(g=>g.id!=r.id),localStorage.setItem("copiaGetDataObjetivos3d",JSON.stringify(n)),location.reload(),console.log("Despues de el for each",n),m.innerHTML="";let d=document.createElement("option");d.text="Escoja una opciÃ³n",d.value=0,m.add(d),n.map(g=>{let p=document.createElement("option");p.text=g.descripcion,p.value=g.id,m.add(p)})});let l=localStorage.getItem("indicesViews"),s=JSON.parse(l);s[5].vista_guardada=0,console.log(s),localStorage.setItem("indicesViews",JSON.stringify(s));let I=localStorage.getItem("curso_id"),S=s[5].nombre_vista_actual,O=route("actualizar-seguimiento",{nombreVista:S,CursoId:I});fetch(O).then(o=>o.json()).then(o=>{console.log(o)}),E()});const w=()=>{document.getElementById("cantidadPreguntas").addEventListener("input",()=>{let t="";const e=event.target.value;for(let a=0;a<e;a++)t+=`
        <div class="mb-3">
        <div class="name">Pregunta </div>
            <div class="input-group wrap-input100 validate-input" >
                <input id="actividad[${a}]" class="form-control" type="text" name="actividad[${a}]" autocomplete="actividad" required>
                <span class="focus-input100 "></span>
        <span class="symbol-input100">
            <i class="fa fa-envelope"></i>
        </span>
            </div>
        </div>
        `;document.getElementById("divPreguntas").innerHTML=t})};function E(){let t=localStorage.getItem("indicesViews"),e=JSON.parse(t),a=localStorage.getItem("curso_id"),i=e[5].nombre_vista_actual,c=route("seguimiento3d",{nombreVista:i,CursoId:a});fetch(c).then(l=>l.json()).then(l=>{console.log(l),l.alcanzado&&(e[5].vista_guardada=1,console.log(e),localStorage.setItem("indicesViews",JSON.stringify(e)),u++,localStorage.setItem("vista_indice",JSON.stringify(u)),localStorage.removeItem("copiaGetDataObjetivos3d"),window.location.href=route("seccion4-create"))})}
