let l=parseInt(localStorage.getItem("vista_indice"));if(localStorage.getItem("indicesViews")){let e=localStorage.getItem("indicesViews"),n=JSON.parse(e),t=n[4];console.log(t.id),console.log(t.vista_guardada);let a=n.find(s=>s.id===l),o=t.id,d=t.vista_guardada===1;o!=l&&d&&m(a.variable_ruta),o!=l&&!d&&m(a.variable_ruta)}else alert("No se ha creado ningun curso, se te redirecionara al panel de control!!"),window.location.href=route("home");function m(e){window.location.href=route(e)}const S=localStorage.getItem("dataObjetivos"),g=JSON.parse(S),b=document.getElementById("selectObjetivoParticular3c"),i=document.getElementById("selectTemas"),h=document.getElementById("cantidadSubtemas"),r=document.getElementById("FormSubtemas");document.getElementById("curso_id");r.style.display="none";let u,p=0,v=0;h.addEventListener("input",function(){this.value<1&&(this.value=1),this.value>15&&(this.value=15)});const c=(e,n)=>{let t=document.createElement("option");return t.text=e,t.value=n,t};g.map(e=>b.add(c(e.descripcion,e.id)));b.onchange=function(){let e=Number(this.value);v=g.find(a=>a.id===e).cursos_id;let t=route("seccion3c-getTemas",{IdObjetivo:e,CursoId:v});fetch(t).then(a=>a.json()).then(a=>{console.log(a),u=a.data,y(),u.length===0?i.add(c("No hay temas, si no encuentra mas temas al escoger objetivos, pase a la siguiente secciÃ³n",0)):(i.add(c("Escoja un Tema",0)),u.map(o=>i.add(c(o.tema,o.id))))})};i.onchange=function(){let e=Number(this.value);r.style.display=e!==0?"block":"none",p=e};document.getElementById("cantidadSubtemas").addEventListener("input",()=>{let e="";const n=event.target.value;for(let t=0;t<n;t++)e+=`<div class="mb-3"><div class="name ">Subtema ${t+1}</div><div class="input-group wrap-input100 validate-input" ><input id="subtema[${t}]" class="form-control" type="text" name="subtema[${t}]" autocomplete="Subtema" required><span class="focus-input100 "></span><span class="symbol-input100"><i class="fa fa-envelope"></i></span></div></div>`;document.getElementById("divSubtemas").innerHTML=e});document.getElementById("FormSubtemas").addEventListener("submit",e=>{e.preventDefault();const n=route("seccion3c-store"),t=document.getElementById("cantidadSubtemas").value,a=new FormData(e.target),o=Object.fromEntries(a.entries());o.subtemas=Array.from({length:t},(s,f)=>({subtema:document.getElementById(`subtema[${f}]`).value,id:p}));const d={method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(o)};fetch(n,d).then(s=>s.json()).then(s=>{console.log(s),y(),i.add(c("Escoja un objetivo",0))})});const y=()=>{r.style.display="none",document.getElementById("divSubtemas").innerHTML="",document.getElementById("cantidadSubtemas").value="",i.innerHTML=""};
