let v=parseInt(localStorage.getItem("vista_indice"));if(localStorage.getItem("indicesViews")){let e=localStorage.getItem("indicesViews"),t=JSON.parse(e),i=t[6];console.log(i.id),console.log(i.vista_guardada);let c=t.find(n=>n.id===v),s=i.id,d=i.vista_guardada===1;s!=v&&d&&q(c.variable_ruta),s!=v&&!d&&q(c.variable_ruta)}else alert("No se ha creado ningun curso, se te redirecionara al panel de control!!"),window.location.href=route("home");function q(e){window.location.href=route(e)}let R=localStorage.getItem("dataObjetivos"),E=[{id:1,descripcion:"Requerimientos en instalaciones, mobiliario y su distribuci칩n"},{id:2,descripcion:"Requerimientos en equipo de apoyo y su distribuci칩n"},{id:3,descripcion:"Requerimientos en materiales did치cticos de apoyo"},{id:4,descripcion:"Requerimientos humanos"},{id:5,descripcion:"Otros (Todo el material extra que no se pueda incluir en las columnas anteriores)"},{id:6,descripcion:"Material y equipo para las medidas de: salud/seguridad/higiene/ protecci칩n civil"}],y=JSON.parse(R),o;localStorage.getItem("copiaGetDataRequerimientos")?o=JSON.parse(localStorage.getItem("copiaGetDataRequerimientos")):o=[...E];let m=0;console.log(m);console.log(o);let r=document.getElementById("selectRequerimiento"),l=0,f=document.getElementById("requerimientos_id"),p=document.getElementById("myForm");p.style.display="none";o.map(e=>{let t=document.createElement("option");t.text=e.descripcion,t.value=e.id,r.add(t)});y?y.forEach(function(e){m=e.cursos_id,console.log(m)}):console.log("El array no existe en el Local Storage");r.onchange=function(){let e=Number(this.value);e!==0?p.style.display="block":p.style.display="none",l=o.find(t=>t.id===e),f.value=l.id,console.log("El objeto seleccionado es: ",l)};document.getElementById("cantidadRequerimientos").addEventListener("input",()=>{let e="";const t=event.target.value;for(let i=0;i<t;i++)e+=`
        <div class="mb-3">
        <div class="name">Requerimiento </div>
            <div class="input-group wrap-input100 validate-input" >
                <input id="requerimiento[${i}]" class="form-control" type="text" name="requerimiento[${i}]" autocomplete="Requerimiento" required>
                <span class="focus-input100 "></span>
        <span class="symbol-input100">
            <i class="fa fa-envelope"></i>
        </span>
            </div>
        </div>
        `;document.getElementById("divRequerimientos").innerHTML=e});document.getElementById("myForm").addEventListener("submit",e=>{e.preventDefault();const t=route("seccion4-store"),i=document.getElementById("cantidadRequerimientos").value,c=new FormData(e.target),s=Object.fromEntries(c.entries());s.requerimientos=[];for(let n=0;n<i;n++){const a={};a.requerimiento=document.getElementById(`requerimiento[${n}]`).value,a.requerimientos_id=f.value,a.cursos_id=m,s.requerimientos.push(a)}console.log(s);const d={method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(s)};fetch(t,d).then(n=>n.json()).then(n=>{console.log(n),p.style.display="none",document.getElementById("divRequerimientos").innerHTML="",console.log("indice para eliminar "+l),o=o.filter(u=>u.id!=l.id),localStorage.setItem("copiaGetDataRequerimientos",JSON.stringify(o)),console.log("Despues de el for each",o),r.innerHTML="";let a=document.createElement("option");a.text="Escoja un Requerimiento",a.value=0,r.add(a),o.map(u=>{let g=document.createElement("option");g.text=u.descripcion,g.value=u.id,r.add(g)})})});
